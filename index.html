<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜é›„å¾®é†ºè½åœ˜ä¹‹æ—…</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Phosphor Icons (åœ–ç¤ºåº«) -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        /* éš±è—æ²è»¸ä½†ä¿ç•™åŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
    </style>
</head>
<body class="text-slate-800">

    <div class="max-w-md mx-auto bg-slate-50 min-h-screen shadow-xl border-x border-slate-200 pb-20 relative">
        
        <!-- Header -->
        <div class="bg-white sticky top-0 z-20 border-b border-slate-200 shadow-sm">
            <div class="p-4 bg-indigo-600 text-white">
                <h1 class="text-xl font-bold flex items-center gap-2">
                    <i class="ph-fill ph-navigation-arrow text-2xl"></i>
                    é«˜é›„å¾®é†ºè½åœ˜ä¹‹æ—…
                </h1>
                <p class="text-indigo-200 text-sm mt-1">12/19 - 12/22 è¡Œç¨‹è¡¨</p>
            </div>
            
            <!-- Date Tabs -->
            <div id="date-tabs" class="flex overflow-x-auto no-scrollbar">
                <!-- Tabs will be injected here -->
            </div>
        </div>

        <!-- Content Area -->
        <div class="p-4">
            
            <!-- Day 2 Toggle (Hidden by default) -->
            <div id="day2-toggle" class="hidden mb-6 bg-white p-1 rounded-xl shadow-sm border border-slate-200 flex">
                <button onclick="setDay2Plan('A')" id="btn-plan-a" class="flex-1 py-2 px-3 rounded-lg text-sm font-bold transition-all">
                    æ–¹æ¡ˆ A: æ——æ´¥/é§äºŒ
                </button>
                <button onclick="setDay2Plan('B')" id="btn-plan-b" class="flex-1 py-2 px-3 rounded-lg text-sm font-bold transition-all">
                    æ–¹æ¡ˆ B: å‹•ç‰©åœ’/é«˜æµ
                </button>
            </div>

            <!-- Timeline Container -->
            <div class="space-y-4 relative">
                <!-- Vertical Line -->
                <div class="absolute left-4 top-2 bottom-4 w-0.5 bg-slate-200 z-0"></div>
                
                <!-- Timeline Items injected here -->
                <div id="timeline-list"></div>
            </div>

            <!-- Footer Message -->
            <div class="mt-8 text-center pb-8">
                <div class="inline-block p-3 rounded-full bg-slate-100 text-slate-400">
                    <i class="ph-fill ph-moon text-2xl"></i>
                </div>
                <p id="footer-msg" class="text-slate-400 text-sm mt-2">ä»Šå¤©çš„è¡Œç¨‹çµæŸäº†ï¼Œæ™šå®‰ï¼</p>
            </div>
        </div>
    </div>

    <script>
        // --- Data ---
        const scheduleData = {
            '12/19': [
                { id: '1-1', time: '14:00', title: 'æŠµé”é«˜é›„', location: 'å·¦ç‡Ÿ/é«˜é›„è»Šç«™', type: 'travel', icon: 'ph-train', note: 'å‰å¾€èœœæ¡ƒå®¶æ”¾è¡Œæ' },
                { id: '1-2', time: '16:00', title: 'å…§æƒŸè—è¡“ä¸­å¿ƒ', location: 'é¼“å±±å€é¦¬å¡é“è·¯329è™Ÿ', type: 'art', icon: 'ph-camera', note: 'ç´”ç™½å»ºç¯‰å¥½æ‹ï¼Œå¯é€›å±•æˆ–çœ‹é›»å½±' },
                { id: '1-3', time: '18:00', title: 'DDC é¤é…’é¤¨', location: 'é¼“å±±å€æ˜Œç››è·¯302è™Ÿ', type: 'food', icon: 'ph-fork-knife', note: 'ğŸ”¥ å»ºè­°æå‰è¨‚ä½', highlight: true },
                { id: '1-4', time: '20:00', title: 'å—å–ƒ Nan Nan å·¥ä½œ', location: 'æ–°èˆˆå€å—è¯è·¯101è™Ÿ', type: 'work', icon: 'ph-briefcase', note: 'å·¥ä½œå…©å°æ™‚ï¼Œè™•ç†å…¬å‹™' },
                { id: '1-5', time: '22:30', title: 'å…­åˆå¤œå¸‚', location: 'å…­åˆäºŒè·¯', type: 'food', icon: 'ph-moon', note: 'å·¥ä½œå¾Œè£œå……èƒ½é‡' },
                { id: '1-6', time: '23:30', title: 'æµªéš› WAVESTELLAR', location: 'å¤§æ¸¯å€‰ä¸ƒåº«', type: 'bar', icon: 'ph-music-notes', note: 'æ¸¯é‚Šå¤œæ™¯èª¿é…’ï¼Œäº«å—æ°›åœ' },
                { id: '1-7', time: 'æ·±å¤œ', title: 'å›èœœæ¡ƒå®¶', location: 'èœœæ¡ƒå®¶', type: 'sleep', icon: 'ph-moon' },
            ],
            '12/20': {
                options: {
                    'A': [
                        { id: '2A-1', time: '13:00', title: 'æ——æ´¥æ¼«éŠ', location: 'æ——æ´¥', type: 'travel', icon: 'ph-sun', note: 'æ­æ¸¡è¼ªã€çœ‹æµ·ã€åƒæµ·é®®' },
                        { id: '2A-2', time: '15:00', title: 'é¹½åŸ•ç¬¬ä¸€å…¬æœ‰å¸‚å ´', location: 'é¹½åŸ•å€', type: 'food', icon: 'ph-fork-knife', note: 'æ–‡é’å°åº—ã€ç”œé»' },
                        { id: '2A-3', time: '16:30', title: 'é§äºŒè—è¡“ç‰¹å€', location: 'é§äºŒ', type: 'art', icon: 'ph-camera', note: 'é€›å¤§ç¾©å€‰åº«ç¾¤' },
                    ],
                    'B': [
                        { id: '2B-1', time: '13:00', title: 'å£½å±±å‹•ç‰©åœ’', location: 'å£½å±±', type: 'travel', icon: 'ph-sun', note: 'çœ‹æ°´è±šã€æ­éŠåœ’å°ç«è»Š' },
                        { id: '2B-2', time: '16:00', title: 'é«˜é›„æµè¡ŒéŸ³æ¨‚ä¸­å¿ƒ', location: 'çœŸæ„›ç¢¼é ­', type: 'art', icon: 'ph-camera', note: 'æµ·éŸ³é¤¨å»ºç¯‰ã€æ¸¯ç£æ•£æ­¥' },
                    ]
                },
                evening: [
                    { id: '2-4', time: '18:00', title: 'è‡ªå¼·å¤œå¸‚æ™šé¤', location: 'è‹“é›…å¸‚å ´/è‡ªå¼·å¤œå¸‚', type: 'food', icon: 'ph-fork-knife', note: 'åœ¨åœ°ç¾é£Ÿå¤šï¼šå—è±é­¯è‚‰é£¯ã€æ°´é¤ƒ' },
                    { id: '2-5', time: '19:30', title: 'ä¸­å¤®å…¬åœ’è½åœ˜', location: 'ä¸­å¤®å…¬åœ’', type: 'music', icon: 'ph-music-notes', note: 'ğŸ„ 2025é«˜é›„è–èª•ç”Ÿæ´»ç¯€', highlight: true },
                    { id: '2-6', time: '22:00', title: 'OFFLINE å–é…’', location: 'æ–°èˆˆå€ç‰ç«¹äºŒè¡—44è™Ÿ', type: 'bar', icon: 'ph-music-notes', note: 'èŒ¶é…’é¤¨ï¼Œæ°£æ°›ä½³' },
                    { id: '2-7', time: 'æ·±å¤œ', title: 'å›èœœæ¡ƒå®¶', location: 'èœœæ¡ƒå®¶', type: 'sleep', icon: 'ph-moon' },
                ]
            },
            '12/21': [
                { id: '3-1', time: '09:00', title: 'æ—©é¤ï¼šèˆˆéš†å±…', location: 'å‰é‡‘å€å…­åˆäºŒè·¯186è™Ÿ', type: 'food', icon: 'ph-fork-knife', note: 'å¿…é»æ¹¯åŒ…ã€ç‡’é¤…æ²¹æ¢' },
                { id: '3-2', time: '11:00', title: 'è‡ªç”±æ´»å‹• / ä¼‘æ¯', location: '-', type: 'rest', icon: 'ph-sun', note: 'å»ºè­°å›é£¯åº—ä¼‘æ¯æˆ–æ‰¾å’–å•¡å»³ï¼Œç‚ºæ™šä¸Šè“„åŠ›' },
                { id: '3-3', time: '19:00', title: 'Doja Cat æ¼”å”±æœƒ', location: 'é«˜é›„å·¨è›‹', type: 'music', icon: 'ph-music-notes', note: 'ğŸ¤ è¨˜å¾—ææ—©å…¥å ´å®‰æª¢', highlight: true },
                { id: '3-4', time: '22:30', title: 'ç‘è±å¤œå¸‚', location: 'è£•èª è·¯/å—å±è·¯', type: 'food', icon: 'ph-moon', note: 'æ¼”å”±æœƒæ•£å ´è¦“é£Ÿ' },
                { id: '3-5', time: 'æ·±å¤œ', title: 'å›æ—…é¤¨ä¼‘æ¯', location: 'æ—…é¤¨', type: 'sleep', icon: 'ph-moon' },
            ],
            '12/22': [
                { id: '4-1', time: '10:00', title: 'å“†å•¦Aå¤¢å±•', location: 'åœ‹ç«‹ç§‘å­¸å·¥è—åšç‰©é¤¨', type: 'art', icon: 'ph-camera', note: 'THE å“†å•¦Aå¤¢å±•ï¼Œé ç•™2-3å°æ™‚', highlight: true },
                { id: '4-2', time: '14:00', title: 'å·¦ç‡Ÿé¾è™å¡”', location: 'è“®æ± æ½­', type: 'travel', icon: 'ph-sun', note: 'é¾å£é€²è™å£å‡ºï¼Œæ¶ˆç½è§£å„' },
                { id: '4-3', time: '16:30', title: 'å‰å¾€è»Šç«™', location: 'å·¦ç‡Ÿé«˜éµ', type: 'travel', icon: 'ph-train', note: 'æº–å‚™è¿”ç¨‹' },
                { id: '4-4', time: '17:00', title: 'å›å°åŒ—', location: 'å°åŒ—', type: 'travel', icon: 'ph-train', note: 'å¹³å®‰è³¦æ­¸' },
            ]
        };

        // --- State ---
        let activeTab = '12/19';
        let day2Plan = 'A'; // 'A' or 'B'
        // Load completed items from local storage if available
        let completedItems = new Set(JSON.parse(localStorage.getItem('kaohsiungTripCompleted') || '[]'));

        // --- Render Functions ---

        function renderTabs() {
            const tabsContainer = document.getElementById('date-tabs');
            tabsContainer.innerHTML = '';
            
            Object.keys(scheduleData).forEach(date => {
                const btn = document.createElement('button');
                const isActive = activeTab === date;
                btn.className = `flex-1 py-3 px-4 text-sm font-medium whitespace-nowrap border-b-2 transition-colors duration-200 ${
                    isActive 
                    ? 'border-indigo-600 text-indigo-600 bg-indigo-50' 
                    : 'border-transparent text-slate-500 hover:text-slate-700 hover:bg-slate-50'
                }`;
                btn.innerText = date;
                btn.onclick = () => {
                    activeTab = date;
                    renderApp();
                };
                tabsContainer.appendChild(btn);
            });
        }

        function renderDay2Toggle() {
            const toggleContainer = document.getElementById('day2-toggle');
            const btnA = document.getElementById('btn-plan-a');
            const btnB = document.getElementById('btn-plan-b');

            if (activeTab === '12/20') {
                toggleContainer.classList.remove('hidden');
                
                // Update button styles based on day2Plan
                if (day2Plan === 'A') {
                    btnA.className = 'flex-1 py-2 px-3 rounded-lg text-sm font-bold transition-all bg-indigo-100 text-indigo-700 shadow-sm';
                    btnB.className = 'flex-1 py-2 px-3 rounded-lg text-sm font-bold transition-all text-slate-400 hover:text-slate-600';
                } else {
                    btnA.className = 'flex-1 py-2 px-3 rounded-lg text-sm font-bold transition-all text-slate-400 hover:text-slate-600';
                    btnB.className = 'flex-1 py-2 px-3 rounded-lg text-sm font-bold transition-all bg-teal-100 text-teal-700 shadow-sm';
                }
            } else {
                toggleContainer.classList.add('hidden');
            }
        }

        function renderFooter() {
             const footerMsg = document.getElementById('footer-msg');
             footerMsg.innerText = activeTab === '12/22' ? 'æ—…ç¨‹çµæŸï¼ŒæœŸå¾…ä¸‹æ¬¡ç›¸è¦‹ï¼' : 'ä»Šå¤©çš„è¡Œç¨‹çµæŸäº†ï¼Œæ™šå®‰ï¼';
        }

        function getDayList() {
            if (activeTab === '12/20') {
                return [...scheduleData['12/20'].options[day2Plan], ...scheduleData['12/20'].evening];
            }
            return scheduleData[activeTab];
        }

        function getTypeColor(type) {
            switch (type) {
                case 'food': return 'bg-orange-100 text-orange-600 border-orange-200';
                case 'music': return 'bg-purple-100 text-purple-600 border-purple-200';
                case 'art': return 'bg-teal-100 text-teal-600 border-teal-200';
                case 'bar': return 'bg-indigo-900 text-indigo-300 border-indigo-700';
                case 'work': return 'bg-gray-800 text-gray-200 border-gray-600';
                case 'travel': return 'bg-blue-100 text-blue-600 border-blue-200';
                case 'sleep': return 'bg-slate-100 text-slate-500 border-slate-200';
                default: return 'bg-gray-100 text-gray-600';
            }
        }

        function toggleComplete(id) {
            if (completedItems.has(id)) {
                completedItems.delete(id);
            } else {
                completedItems.add(id);
            }
            // Save to local storage
            localStorage.setItem('kaohsiungTripCompleted', JSON.stringify([...completedItems]));
            renderTimeline(); // Re-render only timeline for performance, though full re-render is fine here
        }

        function openMap(location) {
            window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location + ' é«˜é›„')}`, '_blank');
        }

        function setDay2Plan(plan) {
            day2Plan = plan;
            renderApp();
        }

        function renderTimeline() {
            const listContainer = document.getElementById('timeline-list');
            listContainer.innerHTML = '';
            const items = getDayList();

            items.forEach(item => {
                const isCompleted = completedItems.has(item.id);
                
                // Outer Wrapper
                const wrapper = document.createElement('div');
                wrapper.className = `relative z-10 pl-10 transition-all duration-300 ${isCompleted ? 'opacity-50 grayscale' : ''}`;

                // Checkbox Button
                const checkBtn = document.createElement('button');
                checkBtn.className = `absolute left-0 top-1.5 w-8 h-8 rounded-full flex items-center justify-center border-2 bg-white transition-colors ${
                    isCompleted 
                    ? 'border-indigo-400 text-indigo-500' 
                    : 'border-slate-300 text-slate-300 hover:border-indigo-400 hover:text-indigo-400'
                }`;
                checkBtn.innerHTML = isCompleted ? '<i class="ph-fill ph-check-circle text-xl"></i>' : '<i class="ph ph-circle text-xl"></i>';
                checkBtn.onclick = () => toggleComplete(item.id);

                // Card
                const card = document.createElement('div');
                card.className = `bg-white rounded-xl p-4 shadow-sm border border-slate-100 hover:shadow-md transition-shadow ${item.highlight ? 'ring-2 ring-yellow-400 ring-opacity-50' : ''}`;

                // Card Header
                const headerDiv = document.createElement('div');
                headerDiv.className = 'flex justify-between items-start mb-2';
                
                // Time & Tag
                const timeTagDiv = document.createElement('div');
                timeTagDiv.className = 'flex items-center gap-2';
                timeTagDiv.innerHTML = `<span class="px-2 py-1 rounded text-xs font-bold border ${getTypeColor(item.type)}">${item.time}</span>`;
                if (item.highlight) {
                    timeTagDiv.innerHTML += `<span class="flex items-center gap-1 text-[10px] bg-red-100 text-red-600 px-1.5 py-0.5 rounded-full font-bold">â˜… é‡é»</span>`;
                }

                // Map Button
                const mapBtn = document.createElement('button');
                mapBtn.className = 'text-slate-400 hover:text-blue-500 transition-colors';
                mapBtn.title = 'åœ¨ Google Maps é–‹å•Ÿ';
                mapBtn.innerHTML = '<i class="ph-fill ph-navigation-arrow text-lg"></i>';
                mapBtn.onclick = () => openMap(item.location !== '-' ? item.location : item.title);

                headerDiv.appendChild(timeTagDiv);
                headerDiv.appendChild(mapBtn);

                // Title
                const title = document.createElement('h3');
                title.className = `font-bold text-lg mb-1 flex items-center gap-2 ${isCompleted ? 'line-through text-slate-400' : 'text-slate-800'}`;
                title.innerHTML = `<i class="${item.icon} opacity-70"></i> ${item.title}`;

                // Location
                let locationDiv = '';
                if (item.location !== '-') {
                    locationDiv = `<div class="flex items-center gap-1 text-slate-500 text-xs mb-2">
                        <i class="ph-fill ph-map-pin"></i> ${item.location}
                    </div>`;
                }

                // Note
                let noteDiv = '';
                if (item.note) {
                    noteDiv = `<div class="bg-slate-50 p-2 rounded-lg text-sm text-slate-600 flex gap-2 items-start mt-2">
                        <i class="ph-fill ph-info text-indigo-400 mt-0.5 flex-shrink-0"></i> ${item.note}
                    </div>`;
                }

                // Assemble Card
                card.appendChild(headerDiv);
                card.appendChild(title);
                if(locationDiv) card.innerHTML += locationDiv;
                if(noteDiv) card.innerHTML += noteDiv;

                wrapper.appendChild(checkBtn);
                wrapper.appendChild(card);
                listContainer.appendChild(wrapper);
            });
        }

        // --- Main Render Loop ---
        function renderApp() {
            renderTabs();
            renderDay2Toggle();
            renderTimeline();
            renderFooter();
        }

        // Initialize
        renderApp();

    </script>
</body>
</html>